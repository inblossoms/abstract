> **Tip ğŸ””ï¼š ä»£ç æ˜¯ä¾›äººé˜…è¯»çš„ï¼Œåªæ˜¯å¶å°”è¦è®¡ç®—æœºæ‰§è¡Œä¸€ä¸‹** > **å‡½æ•°çš„å°è£…æ€§ï¼š**æ˜¯æŒ‡å‡½æ•°ç›¸å…³çš„æ•°æ®å’Œè¡Œä¸ºç»“åˆåœ¨ä¸€èµ·ï¼Œå¯¹è°ƒç”¨è€…éšè—å†…éƒ¨å¤„ç†è¿‡ç¨‹ã€‚

> **å¼‚æ­¥åˆ‡æ¢çŠ¶æ€æ¨¡å— ğŸŒ°:** äº¤é€šç¯ç³»ç»Ÿ

```html
<!-- css -->
<style>
  html,
  body {
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    overflow: hidden;

    /*è®¾ç½®htmlå’Œbodyå…ƒç´ çš„å¸ƒå±€ä¸ºå¼¹æ€§å¸ƒå±€*/
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  header {
    line-height: 2rem;
    font-size: 1.2rem;
    margin-bottom: 20px;
  }
  .traffic {
    /*å°†class=trafficå…ƒç´ è®¾ç½®ä¸ºå¼¹æ€§å¸ƒå±€ï¼Œå®ƒçš„å­å…ƒç´ æŒ‰ç…§ä»ä¸Šé¢åˆ°ä¸‹æ’åˆ—*/
    padding: 10px;
    display: flex;
    flex-direction: column;
  }
  .traffic .light {
    width: 100px;
    height: 100px;
    background-color: #999;
    border-radius: 50%;
  }

  /*å°†class=traffic & class=passå…ƒç´ ä¸‹çš„ç¬¬ä¸€ä¸ªclass=lightçš„å…ƒç´ çš„èƒŒæ™¯è‰²è®¾ç½®ä¸ºç»¿è‰²*/
  .traffic.pass .light:nth-child(1) {
    background-color: #0a6; /*ç»¿ç¯*/
  }
  .traffic.wait .light:nth-child(2) {
    background-color: #cc0; /*é»„ç¯*/
  }
  .traffic.stop .light:nth-child(3) {
    background-color: #c00; /*çº¢ç¯*/
  }
</style>

<!-- html -->
<header>æ¨¡æ‹Ÿäº¤é€šç¯</header>
<main>
  <div class="traffic pass">
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
  </div>
</main>

<!-- 
	å®ç°æ•ˆæœï¼šäº¤é€šæ˜Ÿå·ç¯
	å®ç°éœ€æ±‚ï¼šæ¨¡æ‹Ÿäº¤é€šç¯ä¿¡å·ï¼Œåˆ†åˆ«ä»¥5ç§’ã€1.5ç§’ã€3.5ç§’æ¥å¾ªç¯åˆ‡æ¢ç»¿ç¯ï¼ˆpassçŠ¶æ€ï¼‰ã€é»„ç¯ï¼ˆwaitçŠ¶æ€ï¼‰å’Œçº¢ç¯ï¼ˆstopçŠ¶æ€ï¼‰ã€‚ä¹Ÿå°±æ˜¯ï¼Œé»˜è®¤æ˜¯ç»¿ç¯ï¼Œè¿‡5ç§’åæ˜¾ç¤ºé»„ç¯ï¼Œè¿‡1.5ç§’åæ˜¾ç¤ºçº¢ç¯ï¼Œå†è¿‡3.5ç§’ååˆå›åˆ°ç»¿ç¯ï¼Œç„¶åä»¥è¿™æ ·çš„æ–¹å¼ç»§ç»­å¾ªç¯ä¸‹å»ã€‚
 -->
<!-- js -->

<script>
  const traffic = document.querySelector(".traffic");

  function loop() {
    traffic.className = "traffic pass";
    setTimeout(() => {
      traffic.className = "traffic wait";
      setTimeout(() => {
        traffic.className = "traffic stop";
        setTimeout(loop, 3500);
      }, 1500);
    }, 5000);
  }

  loop();
</script>
```

> **â— ç¼ºé™·åˆ†æï¼š** loop å‡½æ•°è®¿é—®äº†å¤–éƒ¨ç¯å¢ƒ traffic
>
> 1. å¦‚æœæˆ‘ä»¬ä¿®æ”¹äº† HTML ä»£ç ï¼Œå…ƒç´ ä¸å«åš trafficï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šå®•æœº;
> 2. å¦‚æœæˆ‘ä»¬æƒ³æŠŠè¿™ä¸ªå‡½æ•°å¤ç”¨åˆ°å…¶ä»–åœ°æ–¹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é‡å»º traffic å¯¹è±¡;
>
> - traffic ä½œä¸ºåœ¨å‡½æ•°ä¸­ä¸æ˜æ¥æºçš„å˜é‡ï¼Œä»–åœ¨å‡½æ•°å†…éƒ¨æ˜¯ä¸å…·æœ‰æ„ä¹‰çš„ï¼Œå¯¼è‡´å‡½æ•°çš„å°è£…è¢«ç ´åã€‚

> **ğŸ“** æˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°å°† traffic å¯¹è±¡ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼š
>
> - è¿™æ ·æˆ‘ä»¬å°±è§£å†³äº†ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå‡½æ•°ä½“å†…éƒ¨ä¸åº”è¯¥æœ‰å®Œå…¨æ¥è‡ªäºå¤–éƒ¨ç¯å¢ƒçš„å˜é‡ï¼Œé™¤éè¿™ä¸ªå‡½æ•°ä¸æ‰“ç®—å¤ç”¨ã€‚

```html
<!-- çœç•¥å…¶ä»–å†…å®¹ -->
<script>
  const traffic = document.querySelector(".traffic");

  function loop(subject) {
    subject.className = "traffic pass";
    setTimeout(() => {
      subject.className = "traffic wait";
      setTimeout(() => {
        subject.className = "traffic stop";
        setTimeout(loop.bind(null, subject), 3500);
      }, 1500);
    }, 5000);
  }

  loop(traffic);
</script>
```

> **å®ç°å¼‚æ­¥çŠ¶æ€åˆ‡æ¢å‡½æ•°çš„å°è£… ğŸŒ°:**
>
> - ç»§ä¸Šä¸€å°èŠ‚ï¼Œæˆ‘ä»¬å¦‚ä½•åˆ†è£…ä¸€ä¸ªå‡½æ•°è®©ä»–å…·å¤‡é€‚åº”å„ç§ subject çš„çŠ¶æ€åˆ‡æ¢åŠŸèƒ½å‘¢ï¼Ÿ
> - å‡½æ•°ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªå¤„ç†æ•°æ®çš„æœ€å°å•å…ƒã€‚å®ƒåŒ…å«äº†ä¸¤ä¸ªéƒ¨åˆ†ï¼šæ•°æ®å’Œå¤„ç†è¿‡ç¨‹ã€‚
> - æˆ‘ä»¬è¦è®¾è®¡å…·æœ‰é€šç”¨æ€§çš„å‡½æ•°ï¼Œå°±å¯ä»¥æŠ½è±¡æ•°æ®ä¹Ÿå¯ä»¥æŠ½è±¡è¿‡ç¨‹ã€‚

> **æ•°æ®æŠ½è±¡ ğŸš©:** æ•°æ®æŠ½è±¡å°±æ˜¯æŠŠæ•°æ®å®šä¹‰å¹¶èšåˆæˆå¯ä»¥è¢«è¿‡ç¨‹å¤„ç†çš„å¯¹è±¡ï¼Œäº¤ç”±ç‰¹å®šçš„è¿‡ç¨‹å¤„ç†ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼šç»“æ„åŒ–ã€‚
>
> - ç»§ä¸Šä¸€å°èŠ‚ç»§ç»­ï¼šåœ¨ä¸€æ­¥çš„çŠ¶æ€åˆ‡æ¢çš„ä»»åŠ¡æ¥è¯´ï¼Œé¦–å…ˆè¦æ‰¾åˆ°ä»–éœ€è¦å¤„ç†çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ï¼špassã€waitã€stopï¼Œä»¥åŠåˆ‡æ¢çš„æ—¶é—´ï¼š5sã€1.5sã€3.5sã€‚æˆ‘ä»¬å°†æ•°æ®ä» loop å‡½æ•°ä¸­å‰¥ç¦»å‡ºæ¥ï¼š

```html
<script>
  const traffic = document.querySelector(".traffic");

  function sifnalLoop(subject, signals = []) {
    const signalCount = signals.length;

    function updateState(i) {
      const { signal, duration } = signals[i % signalCount];
      subject.className = signal;
      setTimeout(updateState.bind(null, i + 1), duration);
    }

    updateState(0);
  }

  // æ•°æ®æŠ½è±¡
  const signals = [
    { signal: "traffic pass", duration: 5000 },
    { signal: "traffic wait", duration: 1500 },
    { signal: "traffic stop", duration: 3500 },
  ];
  signalLoop(traffic, signals);
</script>
```

> **æ€»ç»“ ğŸ“ƒï¼š**
>
> - è¿™é‡Œæˆ‘ä»¬å°†çŠ¶æ€çŠ¶æ€å’Œäº‹ä»¶æŠ½è±¡æˆä¸€ä¸ªåŒ…å« 3 ä¸ªå¯¹è±¡çš„æ•°ç»„ï¼Œå¹¶å°†è¿™ä¸ªç»“æ„åŒ–çš„æ•°æ®ä¼ é€’åˆ° signalLoop æ–¹æ³•ä¸­ï¼Œåˆ©ç”¨ updateState æ–¹æ³•çš„é€’å½’è°ƒç”¨å®ç°çŠ¶æ€çš„åˆ‡æ¢ï¼›
> - ç»è¿‡æ•°æ®æŠ½è±¡çš„ä»£ç å¯ä»¥é€‚åº”ä¸åŒçŠ¶æ€å’Œäº‹ä»¶çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬åªéœ€ä¿®æ”¹æ•°æ®æŠ½è±¡å³å¯ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹ signalLoop æ–¹æ³•ï¼›
> - æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å°è£… signalLoop æ–¹æ³•ï¼Œæ­¤æ—¶çš„ signalLoop å‡½æ•°ä¸­å­˜åœ¨ä¸€éƒ¨åˆ†æ”¹å˜å¤–éƒ¨çŠ¶æ€çš„ä»£ç ï¼ˆå‰¯ä½œç”¨ä»£ç ï¼‰ã€‚è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘**æŠŠå‡½æ•°ä½“å†…éƒ¨æœ‰å‰¯ä½œç”¨çš„ä»£ç è¿›è¡Œå‰¥ç¦»**ï¼Œä»¥æå‡å‡½æ•°çš„é€šç”¨æ€§ã€ç¨³å®šæ€§ã€å¯æµ‹è¯•æ€§ï¼›

> **å»å‰¯ä½œç”¨åŒ– ğŸŒ°ï¼š**
>
> - ubject.className = `traffic ${signal}`; å› ä¸º subject æ˜¯å¤–éƒ¨å˜é‡ï¼Œè¿™æ¡è¯­å¥æ”¹å˜äº†è¿™ä¸ªå˜é‡çš„ className çŠ¶æ€ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™éƒ¨åˆ†ä¹Ÿä»å‡½æ•°ä¸­å‰¥ç¦»å‡ºå»ï¼š

```html
<script>
  const traffic = document.querySelector(".traffic");

  function signalLoop(subject, signals = [], onSignal) {
    const signalCount = signals.length;
    function updateState(i) {
      const { signal, duration } = signals[i % signalCount];
      onSignal(subject, signal);
      setTimeout(updateState.bind(null, i + 1), duration);
    }
    updateState(0);
  }

  const signals = [
    { signal: "pass", duration: 5000 },
    { signal: "wait", duration: 3500 },
    { signal: "stop", duration: 1500 },
  ];
  signalLoop(traffic, signals, (subject, signal) => {
    subject.className = `traffic ${signal}`;
  });
</script>
```

> **Tip ğŸ””ï¼š** ä»¥ä¸Šæˆ‘ä»¬å®ç°äº†å‰¯ä½œç”¨å‡½æ•°çš„æŠ½ç¦»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¢åŠ ä»£ç  Â·è¯­ä¹‰Â· ä¸å¯è¯»æ€§ï¼›

```html
<script>
  function wait(ms) {
    return new Promise((resolve) => {
      setTimeout(resolve, ms);
    });
  }

  const traffic = document.querySelector(".traffic");

  (async function () {
    while (1) {
      await wait(5000);
      traffic.className = "traffic wait";
      await wait(1500);
      traffic.className = "traffic stop";
      await wait(3500);
      traffic.className = "traffic pass";
    }
  })();
</script>
```

> **æ€»ç»“ ğŸ“ƒï¼š**
>
> - æˆ‘ä»¬é€šè¿‡å°è£… wait å‡½æ•°æ¥æ›¿ä»£ setTimeoutï¼Œå°†æœ‰äº›æ™¦æ¶©çš„ setTimeout åµŒå¥—æ”¹å†™æˆ async å‡½æ•°ä¸­çš„ await å¾ªç¯ï¼Œå¾—ä»¥å¢åŠ ä»£ç çš„è¯­ä¹‰æ€§ã€‚

> **Tip ğŸ”” ï¼šæ¥ä¸‹æ¥æˆ‘ä»¬å¯¹æ•´ä¸ªæ¡ˆä¾‹ä»£ç è¿›è¡Œè¯­ä¹‰åŒ–çš„è½¬æ¢**

```html
<script>
  function wait(ms) {
    return new Promise((resolve) => {
      setTimeout(resolve, ms);
    });
  }

  const traffic = document.querySelector(".traffic");

  async function signalLoop(subject, signals = [], onSignal) {
    const signalCount = signals.length;
    for (let i = 0; ; i++) {
      const { signal, duration } = signals[i % signalCount];
      await onSignal(subject, signal);
      await wait(duration);
    }
  }

  const signals = [
    { signal: "pass", duration: 5000 },
    { signal: "wait", duration: 3500 },
    { signal: "stop", duration: 1500 },
  ];
  signalLoop(traffic, signals, (subject, signal) => {
    subject.className = `traffic ${signal}`;
  });
</script>
```

> **å‡½æ•°çš„æ­£ç¡®æ€§å’Œæ•ˆç‡ âœ¨ï¼š**
>
> - åœ¨ä¿è¯ä»£ç çš„å°è£…æ€§å’Œå¯è¯»æ€§çš„åŒæ—¶ï¼Œä»£ç çš„æ­£ç¡®æ€§æ›´ä¸ºé‡è¦ã€‚æˆ‘ä»¬å¿…é¡»ä¿è¯æ‰€æäº¤çš„ä»£ç æ˜¯æ­£ç¡®çš„ï¼Œå¦åˆ™å°±ä¼šé€ æˆä¸šåŠ¡é€»è¾‘å¤±è´¥ã€‚
> - åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå†™å‡ºé”™è¯¯çš„ä»£ç è€Œä¸è‡ªçŸ¥ã€‚æ¯”å¦‚ï¼šæ´—ç‰Œç®—æ³•çš„é™·é˜±ã€‚

> åœºæ™¯ï¼šç»™å®šä¸€ç»„ç”Ÿæˆå¥½çš„æŠ½å¥–å·ç ï¼Œç„¶åæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—çš„åŠŸèƒ½æ˜¯å°†è¿™ç»„å·ç æ‰“æ•£ï¼ˆå³ï¼Œæ´—ç‰Œï¼‰ç„¶åè¾“å‡ºä¸€ä¸ªä¸­å¥–çš„å·ç ã€‚

```html
<script>
	// æä¾›çš„ä»£ç ç‰‡æ®µ
  function shuffle(items) {
    return [...items].sort((a, b) => (Math.random() > 0.5 ? -1 : 1));
  }

	// ä»£ç å®ç°
</script>
```
