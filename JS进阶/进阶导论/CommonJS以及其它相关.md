## CommonJS

> åœ¨jså‘å±•å‰æœŸï¼Œå®ƒä¸»è¦æ˜¯åœ¨æµè§ˆå™¨ç¯å¢ƒå‘å…‰å‘çƒ­ï¼Œç”±äºESè§„èŒƒè§„èŒƒåŒ–çš„æ—¶é—´æ¯”è¾ƒæ—©ï¼Œæ‰€ä»¥æ¶µç›–çš„èŒƒç•´æ¯”è¾ƒå°ï¼ŒåŠ ä¸Šåç«¯çš„jsè§„èŒƒå´è¿œè¿œè½åï¼Œå¯¹äºjsè‡ªèº«è€Œè¨€ï¼Œå®ƒçš„è§„èŒƒä¾ç„¶æ˜¯ååˆ†è–„å¼±çš„ï¼Œè¿˜å­˜åœ¨ä¸€äº›ä¸¥é‡çš„ç¼ºé™·ï¼Œæ¯”å¦‚ï¼šæ²¡æœ‰æ¨¡å—æ ‡å‡†ã€‚

### 1.0ğŸŒˆä¸ES6æ¨¡å—åŒºåˆ«ï¼š

1. commonJS æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„æ‹·è´ï¼ŒES6æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ã€‚

   - é€šè¿‡eså¯¼å…¥çš„å˜é‡æ˜¯ä¸èƒ½é‡æ–°èµ‹å€¼ä¿®æ”¹çš„ã€‚

2. commonJS æ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæ¥å£ã€‚

   - commonJSåªæœ‰è¿è¡Œæ—¶æ‰èƒ½å¾—åˆ°æ•°æ®å¯¹è±¡ï¼Œå¯¼è‡´æ²¡æœ‰åŠæ³•åœ¨ç¼–è¯‘æ—¶åšâ€˜é™æ€ä¼˜åŒ–â€™ã€‚å› æ­¤commonJSå±äºè¿è¡Œæ—¶æ‰ä¼šåŠ è½½æ¨¡å—çš„æ–¹å¼ï¼Œå³ï¼šè¿è¡Œæ—¶åŠ è½½ï¼›
   - esæ¨¡å—å¯¼å…¥`import {one, tow} form 'file'`, è¿™ç§åŠ è½½åœ¨ç¼–è¯‘æ—¶å°±å®Œæˆæ¨¡å—çš„åŠ è½½ï¼Œå³ï¼šç¼–è¯‘æ—¶åŠ è½½ æˆ–è€… é™æ€åŠ è½½ï¼›

3. CommonsJS æ¨¡å—çš„ `require()`æ˜¯åŒæ­¥åŠ è½½æ¨¡å—ï¼ŒES6 æ¨¡å—çš„`import`å‘½ä»¤æ˜¯å¼‚æ­¥åŠ è½½ï¼Œæœ‰ç‹¬ç«‹çš„æ¨¡å—ä¾èµ–çš„è§£æé˜¶æ®µï¼›

   > ç®€å•ä»‹ç»ä¸€ä¸‹ï¼š
   >
   > `åŒæ­¥åŠ è½½`ï¼šæ‰€è°“åŒæ­¥åŠ è½½å°±æ˜¯åŠ è½½èµ„æºæˆ–è€…æ¨¡å—çš„è¿‡ç¨‹ä¼šé˜»å¡åç»­ä»£ç çš„æ‰§è¡Œï¼›
   > `å¼‚æ­¥åŠ è½½`ï¼šä¸ä¼šé˜»å¡åç»­ä»£ç çš„æ‰§è¡Œï¼›

### 1.1âœ¨Commonjsæ¨¡å—è§„èŒƒ

commonjså¯¹æ¨¡å—çš„å®šä¹‰ååˆ†ç®€å•ï¼Œä¸»è¦åˆ†ä¸º`æ¨¡å—å¼•ç”¨`ã€`æ¨¡å—å®šä¹‰`ã€`æ¨¡å—æ ‡è¯†`ä¸‰ä¸ªéƒ¨åˆ†ã€‚

### 1.1.1âœ¨æ¨¡å—å¼•ç”¨

æ¨¡å—å¼•ç”¨çš„ç¤ºä¾‹ä»£ç ï¼š`const fs = require('fs');`

åœ¨è§„èŒƒä¸­ï¼Œå­˜åœ¨require()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ¥æ”¶`æ¨¡å—æ ‡è¯†`ï¼Œä»¥æ­¤æ¥å…¥ä¸€ä¸ªæ¨¡å—çš„APIåˆ°å½“å‰ä¸Šä¸‹æ–‡ä¸­ã€‚

### 1.1.2 âœ¨æ¨¡å—å®šä¹‰

é™¤äº†å¼•å…¥çš„åŠŸèƒ½ä¹‹å¤–ï¼Œä¸Šä¸‹æ–‡è¿˜æä¾›äº†exportså¯¹è±¡ï¼Œç”¨äºå¯¼å‡ºå½“å‰æ¨¡å—çš„æ–¹æ³•æˆ–è€…å˜é‡ï¼Œå¹¶ä¸”å®ƒæ˜¯å”¯ä¸€å¯¼å‡ºçš„å‡ºå£ï¼›åœ¨æ¨¡å—ä¸­ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªmoduleå¯¹è±¡ï¼Œä»£è¡¨æ¨¡å—è‡ªèº«ï¼Œè€Œexportsæ˜¯moduleçš„å±æ€§ï¼Œåœ¨Nodeä¸­ï¼Œä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå°†æ–¹æ³•æŒ‚è½½åœ¨exportså¯¹è±¡ä¸Šä½œä¸ºå±æ€§å³å¯å®šä¹‰å¯¼å‡ºçš„æ–¹å¼ï¼š

```js
exports.add = function () {
    // â€¦â€¦
};
```

åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡require()æ–¹æ³•å¼•å…¥æ¨¡å—åï¼Œå°±èƒ½è°ƒç”¨æ–¹æ³•æˆ–è€…å±æ€§äº†ï¼š

```js
const math = require('math');
const result = math.add(10, 20);
```

### 1.2.3 âœ¨æ¨¡å—æ ‡è¯†

æ¨¡å—æ ‡è¯†å…¶å®å°±æ˜¯ä¼ é€’ç»™require()å‡½æ•°çš„å‚æ•°ï¼Œå®ƒå¿…é¡»æ˜¯ç¬¦åˆ`å°é©¼å³°å‘½åçš„å­—ç¬¦ä¸²`ï¼Œæˆ–è€…æ˜¯ ä»¥ `.` å’Œ `..` å¼€å¤´çš„ç›¸å¯¹è·¯å¾„æˆ–è€…ç»å¯¹è·¯å¾„ï¼Œå®ƒå¯ä»¥æ²¡æœ‰æ–‡ä»¶ååç¼€.js

æ¨¡å—çš„å®šä¹‰ååˆ†ç®€å•ï¼Œæ¥å£ä¹Ÿååˆ†ç®€æ´ï¼Œå®ƒçš„æ„ä¹‰åœ¨äºå°†ç´¯èšçš„æ–¹æ³•æˆ–è€…å˜é‡é™å®šåœ¨ç§æœ‰çš„ä½œç”¨åŸŸç”¨ï¼ŒåŒæ—¶æ”¯æŒå¼•å…¥å’Œå¯¼å‡ºåŠŸèƒ½ä»¥é¡ºç•…çš„è¡”æ¥ä¸åŒçš„æ¨¡å—ï¼ˆæ–‡ä»¶ï¼‰ï¼Œæ¯ä¸ªæ¨¡å—å…·æœ‰ç‹¬ç«‹çš„ç©ºé—´ï¼Œå®ƒä»¬äº’ä¸å¹²æ‰°ï¼Œåœ¨å¼•ç”¨çš„æ—¶å€™ä¹Ÿæ˜¾å¾—å¹²å‡€åˆ©è½ã€‚

### 2.0ğŸŒˆæ¨¡å—åŠ è½½

ç°åœ¨æˆ‘ä»¬æ­£å¼çš„æ¥è®¤è¯†ä¸€ä¸‹CJsï¼Œåœ¨JSæ²¡æœ‰æ¨¡å—åŒ–ä¹‹å‰ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡ä½œç”¨åŸŸåˆ’åˆ†åˆ©ç”¨å¯¹æ•°æ®è¿›è¡Œå°è£…ï¼Œæ–‡ä»¶åˆ’åˆ†ã€å‘½åç©ºé—´ å’Œ IIFEã€‚

1. æ–‡ä»¶åˆ’åˆ†ï¼šæ–‡ä»¶åˆ’åˆ†æ˜¯æœ€åŸå§‹çš„æ¨¡å—åŒ–å®ç°æ–¹æ¡ˆï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨å‰ç«¯æ¡†æ¶è¿›è¡Œå¼€å‘æ—¶æ‰€åˆ©ç”¨çš„hooksçš„ç¼–ç æ–¹å¼ä¾¿ä¸ä¹‹æœ‰äº›ç±»ä¼¼ï¼Œä½†ä¸å­˜åœ¨æ–‡ä»¶åˆ’åˆ†å¸¦æ¥çš„ç¼ºé™·ï¼Œå› ä¸ºåœ¨å¯¼å…¥æ—¶æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ç°ä»£åŒ–çš„æ¨¡å—å¯¼å…¥æŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¾¹æˆ‘ä»¬æåˆ°çš„ESæ¨¡å—æœºåˆ¶ã€‚

   - æ¨¡å—å˜é‡ç›¸å½“äºæ˜¯åœ¨å…¨å±€è¿›è¡Œäº†å£°æ˜å’Œå®šä¹‰ï¼Œä¸åŒçš„æ¨¡å—ä¸­ä¸å¯é¿å…çš„å­˜åœ¨æœ‰å˜é‡çš„å‘½åå†²çªé—®é¢˜ï¼›
   - ç”±äºå…¨å±€å®šä¹‰çš„ç‰¹ç‚¹ï¼Œå¯¼è‡´æ— æ³•ç¡®å®šå˜é‡çš„å…·ä½“ä½ç½®ï¼Œä¸ºè°ƒè¯•å¢åŠ äº†å›°éš¾ï¼›
   - åœ¨ä¸åŒçš„æ¨¡å—ä¹‹é—´å­˜åœ¨çš„ä¾èµ–å…³ç³»ï¼Œå¯¼è‡´åœ¨å¯¼å…¥é¡ºåºä¸Šå¿…é¡»ä¸¥æ ¼ï¼›

2. å‘½åç©ºé—´ï¼šåœ¨æ—©æœŸçš„JQä¸­ï¼Œè¿™ç§æ–¹å¼æ˜¯å¾ˆå¸¸è§çš„ï¼Œå®ƒå¯ä»¥è§£å†³æ–‡ä»¶åˆ’åˆ†å¸¦æ¥çš„ä¸€äº›é—®é¢˜ä½†æœ‰äº›è‡ƒè‚¿ï¼›

3. IIFE ç«‹å³æ‰§è¡Œå‡½æ•°ï¼šï¼ˆæ¯ä¸ªIIFEéƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹ä½œç”¨åŸŸï¼‰ï¼Œåœ¨ç§æœ‰ä½œç”¨åŸŸä¸­çš„å˜é‡å¤–ç•Œæ— æ³•è®¿é—®ã€‚æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ï¼š

   ```js
   const modal = (()=>{
       funciton init(){
           say()
       }
       
       const say = ()=>{
           console.log(`è¿™æ˜¯ä¸€ä¸ªåˆ©ç”¨ IIFE æ¥å®ç°å¯¹æ•°æ®çš„å°è£…ã€‚`)
       }
       
       return res = {
           init()
       }
   })()
   ```

   ğŸ””æˆ‘ä»¬åœ¨æ¥çœ‹ä¸€ä¸‹å¯¼å…¥å’Œå¯¼å‡ºçš„ä»£ç æ˜¯æ€æ ·è¿›è¡ŒåŠ è½½çš„ï¼š

   ```js
   function loadModule(filename, module, require) {
     const wrappedSrc = `(function (module, exports, require) { 
         ${fs.readFileSync(filename, "utf8")}
         })(module, module.exports, require)`;
     eval(wrappedSrc);
   }
   // å®é™…ä¸Šï¼ŒåŸä»£ç ä¸­è¿˜æœ‰é¢å¤–ä¸¤ä¸ªå‚æ•°ï¼š __filenameå’Œ __dirnameï¼Œè¿™å°±æ˜¯æˆ‘ä»¬åœ¨å†™ä»£ç çš„æ—¶å€™ä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨åˆ°è¿™ä¸¤ä¸ªå˜é‡çš„åŸå› 
   ```

   

